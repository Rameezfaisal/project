CELL-9 â€” UNION ALL (SAP var_out)
ðŸ’¼ Business meaning
This recreates SAPâ€™s final var_out = SELECT â€¦ UNION ALL SELECT â€¦
It produces the complete Part Ecosystem used by Engineering, Supply Chain, and Obsolescence teams.



final_df = main_proj.unionByName(rscxd_proj)






CELL-10 â€” Create the Delta table (SAP schema â†’ Fabric)
ðŸ’¼ Business meaning
We now create the physical reporting table in Fabric that replaces the SAP calculation view.






spark.sql("""
CREATE TABLE IF NOT EXISTS eng_test.rpt_part_ecosystem (
  business_unit STRING,
  ce STRING,
  cmpqpa INT,
  commodity STRING,
  critical STRING,
  curr_cost DOUBLE,
  description STRING,
  enditem STRING,
  lamqoh INT,
  lead_time INT,
  level INT,
  matkl STRING,
  mfg_12mnths_consumption INT,
  mfg_5yrs_consumption INT,
  mfg_dmd INT,
  mfr_part_id STRING,
  mstae STRING,
  name STRING,
  nha STRING,
  obprno STRING,
  obprtflag INT,
  obprtno STRING,
  open_po_qty INT,
  part_status STRING,
  pg_pm STRING,
  po_supplier STRING,
  po_supplier_code STRING,
  pr_supplier STRING,
  pr_supplier_code STRING,
  reltd_ob_pr STRING,
  restricted_all_stock INT,
  sbm STRING,
  smg_group STRING,
  smg_head STRING,
  sprs_5yrs_consumption INT,
  sprs_dmd INT,
  std_cost DOUBLE,
  supplier_code_1050 STRING,
  supplier_code_1060 STRING,
  supplier_code_1090 STRING,
  supplier_code_1900 STRING,
  supplier_code_2000 STRING,
  supplier_code_3120 STRING,
  supplier_name_1050 STRING,
  supplier_name_1060 STRING,
  supplier_name_1090 STRING,
  supplier_name_1900 STRING,
  supplier_name_2000 STRING,
  supplier_name_3120 STRING,
  vencode STRING,
  venname STRING
)
USING DELTA
""")


