AnalysisException                         Traceback (most recent call last)
Cell In[91], line 1
----> 1 final_df = main_proj.unionByName(rscxd_proj)

File /opt/spark/python/lib/pyspark.zip/pyspark/sql/dataframe.py:4043, in DataFrame.unionByName(self, other, allowMissingColumns)
   3965 def unionByName(self, other: "DataFrame", allowMissingColumns: bool = False) -> "DataFrame":
   3966     """Returns a new :class:`DataFrame` containing union of rows in this and another
   3967     :class:`DataFrame`.
   3968 
   (...)
   4041     +----+----+----+----+----+----+
   4042     """
-> 4043     return DataFrame(self._jdf.unionByName(other._jdf, allowMissingColumns), self.sparkSession)

File ~/cluster-env/trident_env/lib/python3.11/site-packages/py4j/java_gateway.py:1322, in JavaMember.__call__(self, *args)
   1316 command = proto.CALL_COMMAND_NAME +\
   1317     self.command_header +\
   1318     args_command +\
   1319     proto.END_COMMAND_PART
   1321 answer = self.gateway_client.send_command(command)
-> 1322 return_value = get_return_value(
   1323     answer, self.gateway_client, self.target_id, self.name)
   1325 for temp_arg in temp_args:
   1326     if hasattr(temp_arg, "_detach"):

File /opt/spark/python/lib/pyspark.zip/pyspark/errors/exceptions/captured.py:185, in capture_sql_exception.<locals>.deco(*a, **kw)
    181 converted = convert_exception(e.java_exception)
    182 if not isinstance(converted, UnknownException):
    183     # Hide where the exception came from that shows a non-Pythonic
    184     # JVM exception message.
--> 185     raise converted from None
    186 else:
    187     raise

AnalysisException: Cannot resolve column name "supplier_code_1900" among (obprno, obprtno, nha, description, cmpqpa, level, matkl, mstae, part_status, vencode, venname, mfg_5yrs_consumption, sprs_5yrs_consumption, mfg_12mnths_consumption, mfg_dmd, sprs_dmd, lamqoh, open_po_qty, std_cost, curr_cost, lead_time, mfr_part_id, name, reltd_ob_pr, commodity, business_unit, pg_pm, smg_group, smg_head, sbm, critical, ce, enditem, obprtflag, po_supplier_code, po_supplier, pr_supplier_code, pr_supplier, suppcd_1900, suppname_1900, suppcd_2000, suppname_2000, suppcd_3120, suppname_3120, suppcd_1050, suppname_1050, suppcd_1060, suppname_1060, suppcd_1090, suppname_1090, restricted_all_stock).
