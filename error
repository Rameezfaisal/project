rscxd_final = (
    rscxd_df.alias("a")
    .join(a_df.alias("ob"), F.col("a.cmpprtno") == F.col("ob.obprtno"), "left")
    .join(rscxd_cons_df.alias("c"), ["cmpprtno","nha"], "left")
    .join(zmfg_df.alias("d"), F.col("a.nha") == F.col("d.matnr"), "left")
    .join(supp_df.alias("e"), F.col("a.nha") == F.col("e.nha"), "left")
    .filter(F.upper(F.col("ob.obpr_state")).isin("CONFIRMED","IN WORK","IN REVIEW"))
)