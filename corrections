spark.sql(f"""
INSERT INTO {tbl_omat_log_tgt} (
    log_desc,
    obpr_count,
    part_count,
    error_count,
    log_ts
)
SELECT
    concat('SP_OMAT_INSERT_NEWOBPR_WklyRefresh - ', d.ob_prno) AS log_desc,
    (SELECT COUNT(*) FROM obprlst)                             AS obpr_count,
    COUNT(DISTINCT d.ob_prtno)                                 AS part_count,
    0                                                         AS error_count,
    current_timestamp()                                       AS log_ts
FROM obprdtls d
GROUP BY d.ob_prno
""")