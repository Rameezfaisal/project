# Cell 3.1: DEBUG - Inspect Source Data

print("--- 1. Raw Table Check ---")
raw_count = prst_df.count()
print(f"Total Rows in Source Table (No Filters): {raw_count}")

if raw_count > 0:
    print("\n--- 2. Data Sample (First 5 Rows) ---")
    prst_df.select("vbak_vkorg", "vbak_auart", "vbap_erdat", "order_status").show(5)

    print("\n--- 3. Distinct Values in Data (Check for Mismatches) ---")
    # Check Sales Orgs present in data
    print("Top 10 Sales Orgs in Data:")
    prst_df.select("vbak_vkorg").distinct().show(10)

    # Check Order Types present in data
    print("Top 10 Order Types in Data:")
    prst_df.select("vbak_auart").distinct().show(10)
    
    # Check Date Range
    print("Date Range in Data (vbap_erdat):")
    prst_df.select(F.min("vbap_erdat"), F.max("vbap_erdat")).show()
    
    print("\n--- 4. Parameter Check ---")
    print(f"Input Sales Orgs: {input_sales_org}")
    print(f"Input Order Types: {input_order_type}")
    print(f"Input Date Range: {from_date} to {to_date} (Flag: {date_flag})")

else:
    print("CRITICAL: The source table 'prst' is completely empty.")
