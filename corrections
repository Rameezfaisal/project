so2.join(mknha, so2.part == mknha.nha, "inner").count()








so2.filter(
    (F.col("ordergroup") == "SO") &
    (F.lower(F.col("orderstatus")) != "closed") &
    (F.col("deliveryduedate") >= dt1wk) &
    (F.col("deliveryduedate") <= dt26wk)
).count()








so2.filter(
    F.col("ordertype").isin(
        "TA","ZCON","ZO09","ZO04","ZSD","ZSO","ZFO","ZUP"
    )
).select("ordertype").distinct().display()








