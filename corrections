


CREATE TABLE IF NOT EXISTS lakehouse.target_materialized_table (
    booking                 STRING,
    carrier                 STRING,
    carrier_name            STRING,
    dlvstatus               STRING,
    etenr                   STRING NOT NULL, -- PK/Key
    expectedqtycumulative   DECIMAL(13,3),
    f1_vbeln                STRING,
    frontload               STRING,
    last_changed            TIMESTAMP,
    lastpgidoc              STRING,
    mard_kinsm              DECIMAL(13,3),
    mard_klabs              DECIMAL(13,3),
    mard_labst              DECIMAL(13,3),
    mard_lgort              STRING,
    mard_matnr              STRING,
    mard_werks              STRING,
    order_status            STRING,
    opendlvdoc              STRING,
    opendlvqty              DECIMAL(13,3),
    pgidate                 DATE,
    pgiqty                  DECIMAL(15,3),
    poreceived              STRING,
    posnr                   STRING NOT NULL, -- PK/Key
    qtyshippedttline        DECIMAL(13,3),
    shipto                  STRING,
    shiptoname              STRING,
    vbak_auart              STRING,
    vbak_aufnr              STRING,
    vbak_autlf              STRING,
    vbak_bstnk              STRING,
    vbak_erdat              DATE,
    vbak_ernam              STRING,
    vbak_faksk              STRING,
    vbak_ihrez              STRING,
    vbak_kunnr              STRING,
    vbak_lifsk              STRING,
    vbak_netwr              DECIMAL(15,2),
    vbak_objnr              STRING,
    vbak_vkorg              STRING,
    vbak_vsnmr_v            STRING,
    vbak_waerk              STRING,
    vbap_abgru              STRING,
    vbap_aedat              DATE,
    vbap_arktx              STRING,
    vbap_charg              STRING,
    vbap_erdat              DATE,
    vbap_ernam              STRING,
    vbap_erzet              STRING, -- Mapped TIME to STRING for compatibility
    vbap_faksp              STRING,
    vbap_grkor              STRING,
    vbap_kdmat              STRING,
    vbap_kwmeng             DECIMAL(15,3),
    vbap_lgort              STRING,
    vbap_lprio              STRING,
    vbap_matnr              STRING,
    vbap_netpr              DECIMAL(11,2),
    vbap_posex              STRING,
    vbap_prodh              STRING,
    vbap_vstel              STRING,
    vbap_werks              STRING,
    vbeln                   STRING NOT NULL, -- PK/Key
    vbep_bmeng              DECIMAL(13,3),
    vbep_edatu              DATE,
    vbep_h_edatu            DATE,
    vbep_lifsp              STRING,
    vbep_mbdat              DATE,
    vbuk_lfgsk              STRING,
    vbuk_wbstk              STRING,
    vbup_lfsta              STRING,
    delvd_qty               DOUBLE
) USING DELTA;






