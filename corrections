
CELL 5 — SUPPLINFO (Master Supplier Mapping)
Purpose:
This step attaches GLIS master supplier information to every R/S NHA.
It answers:
“Does this NHA already have a known buy supplier in the ML master?”




supplinfo = (
    nhalist
    .join(
        ml_part.select(
            F.col("material").alias("nha_cd"),
            F.col("supplier_code").alias("supplierid_cd"),
            F.col("supplier_name").alias("supplier_nm")
        ),
        "nha_cd",
        "left"
    )
)