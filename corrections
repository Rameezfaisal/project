df_omat = (
    spark.read.table(src_omat_dmd_tbl)
    .select(
        F.col("nha"),
        F.col("open_po_qty").cast("int").alias("open_po_qty")
    )
    .groupBy("nha")
    .agg(
        F.max("open_po_qty").alias("open_po_qty")  # SAP semantics
    )
)