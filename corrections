
df_stage5 = (
    spark.table("stage4_basepart_filled")
    .join(spark.table("posupp"), "nha", "left")
    .withColumn("suppcd_po1",F.split("posuppcode",",")[0])
    .withColumn("suppcd_po2",F.split("posuppcode",",")[1])
    .withColumn("suppname_po1",F.split("posuppname",",")[0])
    .withColumn("suppname_po2",F.split("posuppname",",")[1])
)

df_stage5.createOrReplaceTempView("stage5_with_po")
