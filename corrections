ðŸ§© CELL 11 â€” Update rpt_omat_rscxd_dtls with selected supplier
Purpose:
This applies the OMAT-selected supplier back into the operational OMAT table so that
buyers, reports, and dashboards see the correct vendor.
This is the Fabric equivalent of the SAP UPDATE â€¦ FROM statement.




spark.sql(f"""
UPDATE {tgt_rscxd_dtls} AS a
SET
  vencode = b.omat_selected_suppliercd,
  venname = b.omat_selected_supplier,
  po_supplier_code = b.suppcd_po1,
  po_supplier = b.suppname_po1
FROM {tgt_supplier_plants} AS b
WHERE a.nha = b.nha
""")