Cell 12 â€“ Logging (SAP equivalent)

This records:
how many OB parts were processed
how many NHAs were processed
when the procedure ran



obprt_cnt = nhalist.select("cmpprtno").distinct().count()
nha_cnt = nhalist.select("nha").distinct().count()

spark.sql(f"""
INSERT INTO {tgt_log}
(program_name, obpr_cnt, obprtno_cnt, obprtno_nha_cnt, executed_on)
VALUES
('SP_OMAT_INSERT_DMD_CONS_PO', 1, {obprt_cnt}, {nha_cnt}, current_timestamp())
""")





