spark.sql(f"""
INSERT INTO {tbl_omat_log_tgt} (
    executed_on,
    obprtno_cnt,
    obprtno_nha_cnt,
    obpr_cnt,
    program_name
)
SELECT
    current_timestamp()                       AS executed_on,
    COUNT(DISTINCT d.ob_prtno)                AS obprtno_cnt,
    0                                         AS obprtno_nha_cnt,
    (SELECT COUNT(*) FROM obprlst)             AS obpr_cnt,
    concat(
        'SP_OMAT_INSERT_NEWOBPR_WklyRefresh - ',
        d.ob_prno
    )                                         AS program_name
FROM obprdtls d
GROUP BY d.ob_prno
""")