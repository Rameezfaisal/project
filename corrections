# Check the distinct NHA count in your source table
count_source = spark.table(src_omat_dmd_tbl).select("nha").distinct().count()

print(f"Fabric Source NHA Count: {count_source}")
print(f"SAP Target Count: 12263")
print(f"Difference: {12263 - count_source}")









# Check if we are actually getting data from both sides
print("--- EORD Counts ---")
try:
    c1 = spark.read.table(paths["ecc"]["eord"]).count()
    print(f"ECC EORD rows: {c1}")
except:
    print("ECC EORD table missing or empty")

try:
    c2 = spark.read.table(paths["s4h"]["eord"]).count()
    print(f"S4H EORD rows: {c2}")
except:
    print("S4H EORD table missing or empty")








.filter(F.length(F.trim(F.col("supcode_cd"))) > 0)
