
ðŸ“Œ Cell 5 â€” Base join graph
This cell joins together all master and reference data needed to build OMAT part records.
It links each NHA from DMD to:
Selected supplier & plant (from Supplier-by-Plant output)
Material description (MAKT)
Plant data (MARC)
Valuation & cost (MBEW)
Critical & CE flags (AUSP)
Supplier classification hierarchy (ZSUPPLIER_XREF + ZSUPP_CODE_MSTR)
In short:
This creates a single wide dataset containing everything SAP needs to build OMAT_PART_DTLS.
ðŸ“Œ Cell 6 â€” MRP supplier eligibility
This cell implements SAP 107767 logic to decide whether a part has a valid MRP supplier.
It checks if the NHA has a supplier in any of the MRP plants:
Copy code

2000, 1900, 3120, 1050, 1060, 1090
If at least one exists â†’ mrp_supplier = 1, else 0.
In short:
This determines whether the part is MRP-sourced in OMAT.
ðŸ“Œ Cell 7 â€” Final projection
This cell selects and formats exactly the columns required by
eng_test.rpt_omat_part_dtls.
It outputs:
Part identifiers (CMPPRTNO, NHA)
Description, supplier, lead time, costs
Critical & CE flags
Commodity, SMG group, head, SBM
MRP flag
PO supplier details
In short:
This converts the wide joined dataset into the final OMAT schema.
ðŸ“Œ Cell 8 â€” Delta insert
This cell inserts the prepared records into:
Copy code

eng_test.rpt_omat_part_dtls
using an explicit column list to ensure:
ANSI safety
Delta schema enforcement
No positional insert risks
In short:
This writes the final OMAT Part master into Fabric.




