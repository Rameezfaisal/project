CELL 7 â€” Build TEMP Supplier Table (SAP #temp_table)
ðŸ§  Business Meaning
Here we identify:
Suppliers who are NOT the selected OMAT supplier for an NHA, but DO have an OPEN LTB PO
These suppliers must still be tracked because they owe material, even if they are not the preferred supplier.
This replaces SAP temporary table #temp_table.








# Join alternate NHA suppliers with OPEN LTB PO suppliers
temp_table_df = nha_supp_df.alias("ns") \
    .join(
        part_supp_df.alias("ps"),
        (F.col("ns.material_ns") == F.col("ps.material_ps")) &
        (F.col("ns.supcode_ns") == F.col("ps.ltb_supplier_ps")),
        "inner"
    ) \
    .select(
        F.col("ns.material_ns").alias("material_tt"),
        F.col("ns.supcode_ns").alias("vencode_tt"),
        F.col("ns.suppliername_ns").alias("venname_tt"),
        F.col("ps.ltb_po_number").alias("ltbpono_tt")
    ) \
    .distinct()

temp_table_df.cache()
temp_table_df.count()


