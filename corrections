# --- 1. CORE SALES DOCUMENTS (Filtered by Range) ---
# VBEP: Schedule Lines (The primary driver)
df_vbep = spark.read.table(S_VBEP).filter(
    (F.col("vbeln") >= PARAM_LOW_VBELN) & (F.col("vbeln") <= PARAM_HIGH_VBELN)
)

# VBAK: Header
df_vbak = spark.read.table(S_VBAK).filter(
    (F.col("vbeln") >= PARAM_LOW_VBELN) & (F.col("vbeln") <= PARAM_HIGH_VBELN)
)

# VBAP: Item
df_vbap = spark.read.table(S_VBAP).filter(
    (F.col("vbeln") >= PARAM_LOW_VBELN) & (F.col("vbeln") <= PARAM_HIGH_VBELN)
)

# VBUK: Header Status
df_vbuk = spark.read.table(S_VBUK).filter(
    (F.col("vbeln") >= PARAM_LOW_VBELN) & (F.col("vbeln") <= PARAM_HIGH_VBELN)
)

# VBUP: Item Status
df_vbup = spark.read.table(S_VBUP).filter(
    (F.col("vbeln") >= PARAM_LOW_VBELN) & (F.col("vbeln") <= PARAM_HIGH_VBELN)
)

# --- 2. DOCUMENT FLOW & DELIVERIES (Filtered by Preceding Doc) ---
# VBFA: Document Flow (Filter on Preceding Doc VBELV)
df_vbfa = spark.read.table(S_VBFA).filter(
    (F.col("vbelv") >= PARAM_LOW_VBELN) & (F.col("vbelv") <= PARAM_HIGH_VBELN)
)

# LIPS: Delivery Item (Filter on Reference Doc VGBEL = Sales Order)
df_lips = spark.read.table(S_LIPS).filter(
    (F.col("vgbel") >= PARAM_LOW_VBELN) & (F.col("vgbel") <= PARAM_HIGH_VBELN)
)

# LIKP: Delivery Header (Read full; joined later via LIPS)
df_likp = spark.read.table(S_LIKP) 

# CSBG: Spares Deliveries View (Filter on ORDER_NO)
df_csbg = spark.read.table(S_CSBG).filter(
    (F.col("order_no") >= PARAM_LOW_VBELN) & (F.col("order_no") <= PARAM_HIGH_VBELN)
)

# --- 3. MASTER DATA & STATUS ---
# These are dimensional tables loaded lazily
df_jest  = spark.read.table(S_JEST)
df_tj30t = spark.read.table(S_TJ30T)
df_mard  = spark.read.table(S_MARD)
df_kna1  = spark.read.table(S_KNA1)
df_vbpa  = spark.read.table(S_VBPA)
