Cell 4 — Build Active OBPR Base (SAP: BASEDATA)
Business purpose:
Select only active and valid OBPR parts (Confirmed / In Work / In Review) that are eligible to participate in the Make–NHA ecosystem.
This corresponds to the first SAP temp table BASEDATA.





df_basedata = (
    df_obprtno
        .filter(F.col("obpr_state").isin(valid_obpr_states))
        .select(
            F.col("obprno").alias("obprno"),
            F.col("obprtno").alias("obprtno"),
            F.col("part_status").alias("part_status"),
            F.col("reltd_ob_pr").alias("reltd_ob_pr")
        )
        .distinct()
)




