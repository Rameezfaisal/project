
Cell 11.5 — Abort if OMAT source is empty








omat_cnt = spark.table(src_omat_dmd_tbl).count()

if omat_cnt == 0:
    raise Exception(
        f"ABORTED: OMAT source {src_omat_dmd_tbl} is empty. "
        "Skipping overwrite to avoid wiping eng_test.rpt_omat_buynha_suppliers_plants."
    )

print(f"OMAT source row count = {omat_cnt} — safe to proceed")