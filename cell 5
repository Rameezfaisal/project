from pyspark.sql import functions as F

bad_dmddt = (
    problem_report_src
    .select("dmddt")
    .withColumn("normalized", normalize_sap_date("dmddt"))
    .filter(
        F.col("dmddt").isNotNull() &
        ~F.trim(F.col("dmddt")).isin("", "0", "00000000") &
        F.col("normalized").isNull()
    )
)

display(bad_dmddt)