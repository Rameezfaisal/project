Final inclusion logic is still wrong: your base.filter(...) does not implement (cmpprtno = nha) OR (any_metric > 0) because you never use | between conditions; the second block is not OR’ed like the SAP UNION branches..py) 
MFG time window not faithful for 3-year: SAP computes mfg_3yrs_consumption over last 3 years regardless of 5-year window, but your mfg_all applies a global bldat > today-5y before aggregation; this can still be OK but it changes behavior vs SAP if there are edge cases (and is not 1:1)..py)
MAKT join behavior differs: SAP groups by c.maktx in MFG queries; you now group by maktx too (good), but you still join full MAKT without controlling language, which can create multiple rows per MATNR and affect downstream joins unless handled exactly like SAP’s SELECT DISTINCT path..py)
