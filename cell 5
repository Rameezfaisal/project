# Validation: Check Totals by Currency
# Compare these numbers with a simple "SELECT SUM(NETWR), WAERK..." in SAP

df_validation = spark.read.table("lakehouse.rpt_sales_order_optimized")

display(
    df_validation.groupBy("DocCurrency")
    .agg(
        F.count("*").alias("Row_Count"),
        F.sum("GrossSOPriceUSD").alias("Total_Gross_USD"),
        F.sum("OrderLineQty").alias("Total_Qty")
    )
    .orderBy("DocCurrency")
)
