Not fully faithful — these differences will change results. [new 1 | Txt], [lamresearc...epoint.com]


MFG 5-year consumption window is wrong: SAP filters mkpf.bldat > add_days(current_date,-365*5) for mfg_5yrs_consumption; your notebook’s mfg_5yrs_consumption sums over the entire prefiltered set (effectively ~6 years because you filter mjahr >= year-6 / bldat >= today-6years). [new 1 | Txt], [lamresearc...epoint.com]


SAP enforces bldat < current_date; notebook doesn’t (SAP has both > ... and < current_date for MFG windows). This can include future-dated postings in Fabric. [new 1 | Txt], [lamresearc...epoint.com]


SAP inner-joins MAKT in MFG consumption queries; notebook removed it. If a material has no MAKT row, SAP drops it; your notebook will still count it. [new 1 | Txt], [lamresearc...epoint.com]


Join key difference on MKPF: SAP joins mseg.mblnr = mkpf.mblnr (only); notebook joins on mblnr + mjahr. If the HANA CVs behave differently, results can differ. [new 1 | Txt], [lamresearc...epoint.com]


Final “union logic” must exactly match SAP: SAP does SELECT ... WHERE cmpprtno=nha UNION SELECT ... WHERE any_metric>0 (two-branch union). Your notebook replaces it with one filter; it must be an OR between those branches (otherwise row inclusion will differ). [new 1 | Txt], [lamresearc...epoint.com]
