from pyspark.sql import functions as F
from pyspark.sql import Window




# Source tables
src_nha          = "lakehouse.cv_omat_obpn_buy_nha_dtls"
src_inforec     = "lakehouse.cv_zt_inforec_data_sched"
src_eord        = "lakehouse.cv_eord"
src_lfa1        = "lakehouse.cv_lfa1"
src_po_hist     = "lakehouse.cv_zpo_hstry"
src_ekpo        = "lakehouse.cv_ekpo"
src_dmd         = "lakehouse.cv_omat_dmd_consumption_dtls"
src_pr          = "lakehouse.cv_iplm_problem_report_part"

# Targets
tgt_suppliers   = "lakehouse.zt_omat_buynha_suppliers_plants"
tgt_nha         = "lakehouse.omat_obpn_buy_nha_dtls"
tgt_log         = "lakehouse.omat_log_dtls"





df_nha_src   = spark.read.table(src_nha)
df_inforec  = spark.read.table(src_inforec)
df_eord     = spark.read.table(src_eord)
df_lfa1     = spark.read.table(src_lfa1)
df_po_hist  = spark.read.table(src_po_hist)
df_ekpo     = spark.read.table(src_ekpo)
df_dmd      = spark.read.table(src_dmd)
df_pr       = spark.read.table(src_pr)