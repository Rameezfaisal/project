    F.col("ordertype").alias("ordertype"),
    # use the same “best available date” logic, but still filter on the 26-week window
    F.coalesce(
        F.col("deliveryduedate"),
        F.col("requestdate"),
        F.col("firmcommitdate")
    ).alias("demand_date"),
    F.col("openqty").alias("openqty")
