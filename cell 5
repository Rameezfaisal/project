from pyspark.sql import functions as F

prj_df = prj_df.withColumn(
    "dmddt",
    F.coalesce(
        normalize_sap_date("dmddt"),              # real SAP date if valid
        F.lit("1900-01-01T00:00:00Z")               # SAP default
    )
)