# --- Updated Filtering (Removing WERKS Filter to match SAP) ---

df_filtered = df_main.filter(
    (~F.col("a.auart").isin('ZVC', 'ZR07')) & 
    (cond_history | cond_open)
    # REMOVED: (F.col("p.werks") >= '1900') 
)
